[
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"title\"].value",
    "onError": "set-to-blank",
    "newColumnName": "title",
    "columnInsertIndex": 1,
    "description": "Create column title at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"title\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"author_auth_key\"].value",
    "onError": "set-to-blank",
    "newColumnName": "author_auth_key",
    "columnInsertIndex": 1,
    "description": "Create column author_auth_key at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"author_auth_key\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"author_string\"].value",
    "onError": "set-to-blank",
    "newColumnName": "author_string",
    "columnInsertIndex": 1,
    "description": "Create column author_string at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"author_string\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:toNumber(replace(cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"publication_year\"].value,\",\",\"\"))",
    "onError": "set-to-blank",
    "newColumnName": "publication_year",
    "columnInsertIndex": 1,
    "description": "Create column publication_year at index 1 based on column OAI using expression grel:toNumber(replace(cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"publication_year\"].value,\",\",\"\"))"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"bl_language\"].value",
    "onError": "set-to-blank",
    "newColumnName": "bl_language",
    "columnInsertIndex": 1,
    "description": "Create column bl_language at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"bl_language\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"publisher_number\"].value",
    "onError": "set-to-blank",
    "newColumnName": "publisher_number",
    "columnInsertIndex": 1,
    "description": "Create column publisher_number at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"publisher_number\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"ean\"].value",
    "onError": "set-to-blank",
    "newColumnName": "ean",
    "columnInsertIndex": 1,
    "description": "Create column ean at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"ean\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"cnb\"].value",
    "onError": "set-to-blank",
    "newColumnName": "cnb",
    "columnInsertIndex": 1,
    "description": "Create column cnb at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"cnb\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"ismn\"].value",
    "onError": "set-to-blank",
    "newColumnName": "ismn",
    "columnInsertIndex": 1,
    "description": "Create column ismn at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"ismn\"].value"
  },  
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"issn\"].value",
    "onError": "set-to-blank",
    "newColumnName": "issn",
    "columnInsertIndex": 1,
    "description": "Create column issn at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"issn\"].value"
  },  
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"isbn\"].value",
    "onError": "set-to-blank",
    "newColumnName": "isbn",
    "columnInsertIndex": 1,
    "description": "Create column isbn at index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"isbn\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"format\"].value",
    "onError": "set-to-blank",
    "newColumnName": "format",
    "columnInsertIndex": 1,
    "description": "Create column format index 1 based on column OAI using expression grel:cell.cross(\"KNIHOVNA_klice csv\", \"record_id\")[0].cells[\"format\"].value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "title",
    "expression": "grel:if(length(value)<16,\"<16\",\">=16\")",
    "onError": "set-to-blank",
    "newColumnName": "titleLength",
    "columnInsertIndex": 13,
    "description": "Create column titleLength at index 13 based on column title using expression grel:if(length(value)<16,\"<16\",\">=16\")"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "publication_year",
    "expression": "grel:if(isNonBlank(value),if(value<1989,\"<1989\",\">=1989\"),null)",
    "onError": "set-to-blank",
    "newColumnName": "1989isn",
    "columnInsertIndex": 10,
    "description": "Create column 1989isn at index 10 based on column publication_year using expression grel:if(isNonBlank(value),if(value<1989,\"<1989\",\">=1989\"),null)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "publication_year",
    "expression": "grel:toNumber(cells[\"008\"].value.substring(7,11))==value",
    "onError": "set-to-blank",
    "newColumnName": "yearMatch",
    "columnInsertIndex": 10,
    "description": "Create column yearMatch at index 10 based on column publication_year using expression grel:toNumber(cells[\"008\"].value.substring(7,11))==value"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "isbn",
    "expression": "grel:if(isNonBlank(cells[\"OAI\"].value),if(and(isBlank(value),isNonBlank(replace(cells[\"020\"].value.match(/.*\\$a([^\\$]+).*/)[0],/[^0-9Xx\\-]/,\"\"))),\"invalid\",null),null)",
    "onError": "set-to-blank",
    "newColumnName": "isbnValidity",
    "columnInsertIndex": 3,
    "description": "Create column isbnValidity at index 3 based on column isbn using expression grel:if(isNonBlank(cells[\"OAI\"].value),if(and(isBlank(value),isNonBlank(replace(cells[\"020\"].value.match(/.*\\$a([^\\$]+).*/)[0],/[^0-9Xx\\-]/,\"\"))),\"invalid\",null),null)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "record-based"
    },
    "baseColumnName": "OAI",
    "expression": "grel:if(isNonBlank(value),value+\"\\t\"+\nif(isNonBlank(cells[\"100\"].value.match(/.*\\$a([^\\$]+).*/)[0]),cells[\"100\"].value.match(/.*\\$a([^\\$]+).*/)[0],if(isNonBlank(cells[\"110\"].value.match(/.*\\$a([^\\$]+).*/)[0]),cells[\"110\"].value.match(/.*\\$a([^\\$]+).*/)[0],\"\"))+\"\\t\"+cells[\"245\"].value.match(/.*\\$a([^\\$]+).*/)[0]+\"\\t\"+if(isNonBlank(cells[\"publication_year\"].value),cells[\"publication_year\"].value,\"\"),null)",
    "onError": "set-to-blank",
    "newColumnName": "output",
    "columnInsertIndex": 1,
    "description": "Create column output at index 1 based on column OAI using expression grel:if(isNonBlank(value),value+\"\\t\"+\nif(isNonBlank(cells[\"100\"].value.match(/.*\\$a([^\\$]+).*/)[0]),cells[\"100\"].value.match(/.*\\$a([^\\$]+).*/)[0],if(isNonBlank(cells[\"110\"].value.match(/.*\\$a([^\\$]+).*/)[0]),cells[\"110\"].value.match(/.*\\$a([^\\$]+).*/)[0],\"\"))+\"\\t\"+cells[\"245\"].value.match(/.*\\$a([^\\$]+).*/)[0]+\"\\t\"+if(isNonBlank(cells[\"publication_year\"].value),cells[\"publication_year\"].value,\"\"),null)"
  }
]